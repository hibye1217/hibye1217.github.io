<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../Style/Main.css">
    <title>EG - TTT</title>
    <style>
        .box{
            background-color: #EEEEEE;
            width: 100px;
            height: 100px;
        }
        .box:hover{
            background-color: #DDDDDD;
        }
        .box:active{
            background-color: #BBBBBB;
        }

        .up{
            border-top: 1px solid black;
        }
        .down{
            border-bottom: 1px solid black;
        }
        .right{
            border-right: 1px solid black;
        }
        .left{
            border-left: 1px solid black;
        }

        #hide{
            visibility: hidden;
        }
    </style>
    <script>
        var map = new Array(10);
        for (let i = 0; i < 3; i++){
            map[i] = new Array(10);
            for (let j = 0; j < 3; j++){
                map[i][j] = 0;
            }
        }
        var turn = 1;
        var play = true;
        var score1 = 0, score2 = 0;

        function win(t){
            if (map[0][0] == t && map[0][1] == t && map[0][2] == t) return true;
            if (map[1][0] == t && map[1][1] == t && map[1][2] == t) return true;
            if (map[2][0] == t && map[2][1] == t && map[2][2] == t) return true;

            if (map[0][0] == t && map[1][0] == t && map[2][0] == t) return true;
            if (map[0][1] == t && map[1][1] == t && map[2][1] == t) return true;
            if (map[0][2] == t && map[1][2] == t && map[2][2] == t) return true;

            if (map[0][0] == t && map[1][1] == t && map[2][2] == t) return true;
            if (map[2][0] == t && map[1][1] == t && map[0][2] == t) return true;
            
            return false;
        }

        function tie(){
            if (map[0][0] != 0 && map[0][1] != 0 && map[0][2] != 0 && 
                map[1][0] != 0 && map[1][1] != 0 && map[1][2] != 0 && 
                map[2][0] != 0 && map[2][1] != 0 && map[2][2] != 0) return true;
            return false;
        }

        function fill(z, tag){
            if (!play) return;
            var x = z%10, y = parseInt(z/10);
            if (map[y][x] != 0){
                return;
            }
            map[y][x] = turn;
            if (turn == 1){
                tag.innerHTML = "O";
                tag.style.color = "#FF0000";
                tag.style.fontSize = "72px";
                turn = 2;
                var vs = document.getElementById('vs');
                vs.style.color = "#0000FF";
            }
            else{
                tag.innerHTML = "X";
                tag.style.color = "#0000FF";
                tag.style.fontSize = "72px";
                turn = 1;
                var vs = document.getElementById('vs');
                vs.style.color = "#FF0000";
            }

            if (win(1)){
                play = false;
                var p = document.getElementById('p1');
                score1 += 1;
                p.innerHTML = "O " + score1;
                var hide = document.getElementById('hide');
                hide.style.visibility = "visible";
            }
            if (win(2)){
                play = false;
                var p = document.getElementById('p2');
                score2 += 1;
                p.innerHTML = score2 + " X";
                var hide = document.getElementById('hide');
                hide.style.visibility = "visible";
            }
            if (tie()){
                play = false;
                var hide = document.getElementById('hide');
                hide.style.visibility = "visible";
            }
        }

        function reset(){
            play = true;
            for (let i = 0; i < 3; i++){
                for (let j = 0; j < 3; j++){
                    map[i][j] = 0;
                }
            }
            hide.style.visibility = "hidden";
            var tds = document.getElementsByTagName('td');
            for (let i = 0; i < tds.length; i++) tds[i].innerHTML = "";
        }
    </script>
</head>
<body>
    <header>
        <div id="title" onclick="location.href='../Main.html'">
            <div id="title_text">TicTacToe</div>
        </div>
    </header>
    <section id="body">
        <div id="body-flex" style="width: 100%; display: flex; justify-content: center;">
            <div id="flex-body">
                <div id="table">
                    <h2>
                        <span id="p1" style="color: #FF0000">O 0</span>
                        <span id="vs" style="color: #FF0000"> : </span>
                        <span id="p2" style="color: #0000FF">0 X</span>
                    </h2>
                    <table style="border-collapse: collapse;">
                        <tr>
                            <td class="box down right" onclick="fill(00, this)"></td>
                            <td class="box down right left" onclick="fill(01, this)"></td>
                            <td class="box down left" onclick="fill(02, this)"></td>
                        </tr>
                        <tr>
                            <td class="box up down right" onclick="fill(10, this)"></td>
                            <td class="box up down right left" onclick="fill(11, this)"></td>
                            <td class="box up down left" onclick="fill(12, this)"></td>
                        </tr>
                        <tr>
                            <td class="box up right" onclick="fill(20, this)"></td>
                            <td class="box up right left" onclick="fill(21, this)"></td>
                            <td class="box up left" onclick="fill(22, this)"></td>
                        </tr>
                    </table>
                </div>
                <br>
                <div>
                    <button id="hide" onclick="reset()">Reset Map</button>
                </div>
            </div>
        </div>
    </section>
</body>
</html>